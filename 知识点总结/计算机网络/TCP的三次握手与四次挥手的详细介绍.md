TCP的三次握手与四次挥手的详细介绍
    
    TCP三次握手：

        第一次握手：客户端发送位码SYN(建立联机)=1，随机产生seq number = J。
        客户端进入SYN_SENT状态，等待请求确认。
        服务端由SYN=1可以知道客户端要求建立连接；

        第二次握手：服务端接受请求之后需要确认，发送位码SYN=1、ACK(确认)=1，ack number = J+1，随机产生seq number = K。
        服务端进入SYN_RCVD状态；

        第三次握手：客户端接受数据包之后，确认ack number是否正确(是否为J+1)和ACK是否为1。
        若正确，客户端发送位码SYN=1，ACK=1，ack number = K+1。
        服务端接收后确认ack number和ACK，正确则成功建立连接。
        服务端和客户端进入ESTABLISHED状态。

    TCP四次挥手(TCP连接时为全双工，每个方向都必须要单独进行关闭)：

        第一次挥手：数据传输完成之后，客户端进程发出连接释放报文，并停止发送数据。
        客户端进入FIN_WAIT_1状态，释放报文位码FIN = 1，序列号seq number = u(是前面已经传送过来的数据的最后一个字节的序号+1)；

        第二次挥手：服务端接收到释放报文之后，发出确认报文，ACK = 1， ack number = u+1，并随机产生seq number = V。
        服务器进入CLOSE_WAIT状态；客户端接收到确认报文之后，进入FIN_WAIT_2状态，等待接收服务端发送的连接释放报文；

        第三次挥手：当服务端数据传输完成，服务端发送连接释放报文FIN=1，ack=u+1，产生随机序列号seq number = W。
        服务端进入LAST_ACK状态，等待客户端确认；

        第四次挥手：客户端接受到服务端的链接释放报文之后，给服务端发送确认报文，ACK=1，ack number = W+1。
        客户端进入TIME_WAIT状态，等待2MSL(MSL:报文最大生存时间)，然后关闭连接。
        服务端接收到确认报文之后立即进入CLOSE状态。

问题1：为什么第四次握手需要等待2MSL的时间？

        1、如果客户端在发送完确认报文之后不等待，直接释放连接，
        若此时服务端发生重传，那么本次连接的报文有可能会和下次连接的报文产生冲突，
        所以需要等待2MSL时间让本次连接的报文完全消失。
        2、保证最后一次握手报文能到达服务端，能进行超时重传

问题2：连接是什么？

        连接实际上是指客户端和服务端开辟对应的资源。

问题3：TCP为什么需要3次握手建立连接(为什么不用两次或者四次)？

        TCP协议位于传输控制层，核心思想是既保证传输数据可靠，又保证高传输效率；

        不用两次握手是因为两次握手不能保证可靠传输：防止失效的连接请求报文段被服务端接收，从而产生错误.(seq numbers序列号完成TCP的可靠连接-同步确认)
        A->B 我的seq numbers是X1
        B->A 收到(ack),你的seq numbers是X1
        B->A 我的seq numbers是X2
        A->B 收到，你的seq numbers是X2
        如果没有第三次握手，无法保证服务端接受的链接请求包是同步的(时钟，ISN)

        不用四次握手是因为高效传输，将B->A的两次压缩到一次

个人理解：三次握手、四次挥手
        
        三次握手：
                第一次握手：服务端确认客户端传输数据无丢失，确认客户端传输数据可靠；
                第二次握手：客户端确认服务端接受数据可靠，且传输数据可靠；
                第三次握手：服务端确认客户端接收数据可靠。

        四次挥手：
                第一次挥手：服务端得知客户端停止数据发送，确认释放接收客户端发送数据的连接；
                第二次挥手：客户端确认服务端释放连接(客户端释放发送数据至服务端的连接)
                第三次挥手：客户端得知服务端停止传送数据，确认释放接收服务端发送数据的连接；
                第四次挥手：服务端确认客户端释放连接(服务端释放发送数据到客户端的连接)



